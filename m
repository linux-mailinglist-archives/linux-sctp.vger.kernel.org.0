Return-Path: <linux-sctp-owner@vger.kernel.org>
X-Original-To: lists+linux-sctp@lfdr.de
Delivered-To: lists+linux-sctp@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.lfdr.de (Postfix) with ESMTP id A0DF2FBA1
	for <lists+linux-sctp@lfdr.de>; Tue, 30 Apr 2019 16:39:15 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1726229AbfD3Ohy (ORCPT <rfc822;lists+linux-sctp@lfdr.de>);
        Tue, 30 Apr 2019 10:37:54 -0400
Received: from mail-qt1-f194.google.com ([209.85.160.194]:34303 "EHLO
        mail-qt1-f194.google.com" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S1726164AbfD3Ohy (ORCPT
        <rfc822;linux-sctp@vger.kernel.org>); Tue, 30 Apr 2019 10:37:54 -0400
Received: by mail-qt1-f194.google.com with SMTP id j6so16407799qtq.1
        for <linux-sctp@vger.kernel.org>; Tue, 30 Apr 2019 07:37:54 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20161025;
        h=from:to:cc:subject:date:message-id:mime-version
         :content-transfer-encoding;
        bh=ZF+o6w5PUmbrgMQipiRCTsm8Z4KTMX85R8w+DONX6QY=;
        b=AWsS1ZwNwZi3fC2DE/8JnMkX1Hc+zthcmHfFs03QCjg21zKhoQpJ0zGeSOtWeiKslD
         0hZ0fXWfvzi9uNExzad1bymhKO+H+O3RXiNxA1OARDFm1b+NcFrmjf//eyDEWjZlVQDn
         CV9YdFLnP0YvomtEPDwwjM+Qp5eIR2rEtxcH7B+Tm89JLjinAEO7rGzQt70UaMYPa1vv
         WUfWVIfMx2/KQMw5ppvxeyNC50oF8erK+bN9umONU7+KWpvK7VukNm6stSwaNA8AJYY1
         msPguQVnuI3GO2QGsOTNKgoG8PVbWFv82UCaoaNE8RX9oNh3g0+mkEXydb5m9WACdKQR
         sOgA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20161025;
        h=x-gm-message-state:from:to:cc:subject:date:message-id:mime-version
         :content-transfer-encoding;
        bh=ZF+o6w5PUmbrgMQipiRCTsm8Z4KTMX85R8w+DONX6QY=;
        b=JrkN0f4rVVhIjxIra8ut1CZdFI5qqugrs+pGFNNFn6bjGmEIwHPrzuKFretK1aoknY
         hvcLbNe7cbCXJWsebT1BN9JDH5qON7+92KPuG2KrzUpDIO1rWkcth7dwisBGR9RKcO9A
         7sFNTw7tiWeJ/c1ezkXOUQXYBG0vNg1z8Z8Hi+HWlD8aQqLSVLTTVxzZuUwGsphaLdY8
         INDeIR8K8ogeOUVUJ88M9/Ko0hVs/RipowR9JFoMDkt2cSA+bNkqBMVEqz5mNH5t/d2j
         w7biKlA0PxFApCVv8O7IBByef4zh/Io+ZMHWSK13A4x6yN2gIEeUX+G3wNlMPfS/q7lT
         gzUQ==
X-Gm-Message-State: APjAAAVr7ZQA9MYnsxDU/D51oJot1jkYlcCMo7Xy3VB0Hb6pAZsW4RbP
        sLIPTB/RfS/FmnqgplP/KiY=
X-Google-Smtp-Source: APXvYqwqpj5gyUM3eD9YBiLUI2+bvJMbm56uzc8arVQhKSpWb/XB6z93gH5HS6Br+pv2rFWBdzxyRw==
X-Received: by 2002:a0c:b620:: with SMTP id f32mr47595731qve.228.1556635073234;
        Tue, 30 Apr 2019 07:37:53 -0700 (PDT)
Received: from localhost.localdomain ([2001:1284:f013:68ab:38f4:1276:793c:951a])
        by smtp.gmail.com with ESMTPSA id m24sm1464891qka.83.2019.04.30.07.37.52
        (version=TLS1_2 cipher=ECDHE-RSA-CHACHA20-POLY1305 bits=256/256);
        Tue, 30 Apr 2019 07:37:52 -0700 (PDT)
Received: by localhost.localdomain (Postfix, from userid 1000)
        id DFB4E180CF7; Tue, 30 Apr 2019 11:37:49 -0300 (-03)
From:   Marcelo Ricardo Leitner <marcelo.leitner@gmail.com>
To:     linux-sctp@vger.kernel.org
Cc:     Marcelo Ricado Leitner <marcelo.leitner@gmail.com>
Subject: [PATCH lksctp-tools] automake: fix include dir for the now autogenerated header
Date:   Tue, 30 Apr 2019 11:37:41 -0300
Message-Id: <0b162bbbbbc8d057c751d749c193b158408328f1.1556634957.git.marcelo.leitner@gmail.com>
X-Mailer: git-send-email 2.20.1
MIME-Version: 1.0
Content-Transfer-Encoding: 8bit
Sender: linux-sctp-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-sctp.vger.kernel.org>
X-Mailing-List: linux-sctp@vger.kernel.org

After 9607dd85e70a ("netinet/sctp.h: dynamically build based on system
setup") the header file is generated on the builddir and won't be
located in the srcdir anymore. This broke builds using different dirs
for building other than the src dir.

Fix it by telling automake to use the include dir based on top_builddir
instead.

Fixes #30

Fixes: 9607dd85e70a ("netinet/sctp.h: dynamically build based on system setup")
Reported-by: Alexander Gallego
Signed-off-by: Marcelo Ricardo Leitner <marcelo.leitner@gmail.com>
---
 src/apps/Makefile.am       | 2 +-
 src/func_tests/Makefile.am | 2 +-
 src/lib/Makefile.am        | 2 +-
 src/testlib/Makefile.am    | 2 +-
 src/withsctp/Makefile.am   | 2 +-
 5 files changed, 5 insertions(+), 5 deletions(-)

diff --git a/src/apps/Makefile.am b/src/apps/Makefile.am
index 7e33b9c87f003cadcd1f674012b0eb4147c55c71..7e32306a61b985bf9efbe088a30bef9e2154e1d4 100644
--- a/src/apps/Makefile.am
+++ b/src/apps/Makefile.am
@@ -4,7 +4,7 @@ include $(top_srcdir)/Makefile.rules
 include $(top_srcdir)/Makefile.dirs
 
 # General compilation flags
-AM_CPPFLAGS = -I. -I$(top_srcdir)/src/include -I$(top_srcdir)/src/testlib \
+AM_CPPFLAGS = -I. -I$(top_builddir)/src/include -I$(top_srcdir)/src/testlib \
               -g -O2 -fno-strict-aliasing -Wall -Wstrict-prototypes \
               -Wimplicit-function-declaration
 
diff --git a/src/func_tests/Makefile.am b/src/func_tests/Makefile.am
index 495adcf352caf2aa446b4dec599a289a6bb05205..e5bf454cde73bd7944e5543c90251fdbb6eb8271 100644
--- a/src/func_tests/Makefile.am
+++ b/src/func_tests/Makefile.am
@@ -4,7 +4,7 @@ include $(top_srcdir)/Makefile.rules
 include $(top_srcdir)/Makefile.dirs
 
 # General compilation flags
-AM_CPPFLAGS = -I. -I$(top_srcdir)/src/include -I$(top_srcdir)/src/testlib \
+AM_CPPFLAGS = -I. -I$(top_builddir)/src/include -I$(top_srcdir)/src/testlib \
               -g -O2 -fno-strict-aliasing -Wall -Wstrict-prototypes \
               -Wimplicit-function-declaration
 
diff --git a/src/lib/Makefile.am b/src/lib/Makefile.am
index 1d62175c71b7e9b7b59d987c5781902d5f96d9db..1296caae653b60bc53d7aaa3d2eefbb78f9ff63a 100644
--- a/src/lib/Makefile.am
+++ b/src/lib/Makefile.am
@@ -4,7 +4,7 @@ include $(top_srcdir)/Makefile.rules
 include $(top_srcdir)/Makefile.dirs
 
 # General compilation flags
-AM_CPPFLAGS = -I$(top_srcdir)/src/include
+AM_CPPFLAGS = -I$(top_builddir)/src/include
 
 lib_LTLIBRARIES = libsctp.la
 
diff --git a/src/testlib/Makefile.am b/src/testlib/Makefile.am
index fae6bbcef610874d5e64951ca21e6df160112cca..b94961109591c097ab9f7b9c1aa34bce89e5a430 100644
--- a/src/testlib/Makefile.am
+++ b/src/testlib/Makefile.am
@@ -5,7 +5,7 @@ include $(top_srcdir)/Makefile.rules
 include $(top_srcdir)/Makefile.dirs
 
 # General compilation flags
-AM_CPPFLAGS = -I$(top_srcdir)/src/include
+AM_CPPFLAGS = -I$(top_builddir)/src/include
 
 noinst_LTLIBRARIES = libsctputil.la
 libsctputil_la_SOURCES = sctputil.c sctputil.h
diff --git a/src/withsctp/Makefile.am b/src/withsctp/Makefile.am
index 1f6ca37062d6c85ad6f127d72f23514109c92d9c..31575886d703584d79a889eba104f36295a3f708 100644
--- a/src/withsctp/Makefile.am
+++ b/src/withsctp/Makefile.am
@@ -10,7 +10,7 @@ include $(top_srcdir)/Makefile.rules
 bin_PROGRAMS = checksctp
 bin_SCRIPTS = withsctp
 
-AM_CPPFLAGS=-I$(top_srcdir)/src/include
+AM_CPPFLAGS=-I$(top_builddir)/src/include
 pkglib_LTLIBRARIES = libwithsctp.la
 libwithsctp_la_SOURCES = sctp_load_libs.c sctp_socket.c sctp_bind.c \
 	sctp_sockopt.c sctp_socket.h
-- 
2.20.1

