Return-Path: <linux-sctp+bounces-294-lists+linux-sctp=lfdr.de@vger.kernel.org>
X-Original-To: lists+linux-sctp@lfdr.de
Delivered-To: lists+linux-sctp@lfdr.de
Received: from ny.mirrors.kernel.org (ny.mirrors.kernel.org [IPv6:2604:1380:45d1:ec00::1])
	by mail.lfdr.de (Postfix) with ESMTPS id 9D1D59F674D
	for <lists+linux-sctp@lfdr.de>; Wed, 18 Dec 2024 14:31:54 +0100 (CET)
Received: from smtp.subspace.kernel.org (relay.kernel.org [52.25.139.140])
	(using TLSv1.2 with cipher ECDHE-ECDSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by ny.mirrors.kernel.org (Postfix) with ESMTPS id D037B163EE9
	for <lists+linux-sctp@lfdr.de>; Wed, 18 Dec 2024 13:31:51 +0000 (UTC)
Received: from localhost.localdomain (localhost.localdomain [127.0.0.1])
	by smtp.subspace.kernel.org (Postfix) with ESMTP id BCD4319B5B1;
	Wed, 18 Dec 2024 13:31:48 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org;
	dkim=pass (1024-bit key) header.d=viavisolutions.com header.i=@viavisolutions.com header.b="EOBHIRhn"
X-Original-To: linux-sctp@vger.kernel.org
Received: from NAM12-MW2-obe.outbound.protection.outlook.com (mail-mw2nam12on2135.outbound.protection.outlook.com [40.107.244.135])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by smtp.subspace.kernel.org (Postfix) with ESMTPS id 838B117C219
	for <linux-sctp@vger.kernel.org>; Wed, 18 Dec 2024 13:31:46 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org; arc=fail smtp.client-ip=40.107.244.135
ARC-Seal:i=2; a=rsa-sha256; d=subspace.kernel.org; s=arc-20240116;
	t=1734528708; cv=fail; b=vDUhkPP75NCgxNk5H9ke7XcVf0PyUHbsCo+l88O2By7C5ScXxdOH7oSYynghjTcCPRf4vXOyx6s0+enFMgnAMExOR8iZG1mnnLMT/YLq/OrqiatVAXCP4EiVj981nMOIV29/3iFu0KAn8GH6J/yQbL+DYspj+khCUBbBFkyueQM=
ARC-Message-Signature:i=2; a=rsa-sha256; d=subspace.kernel.org;
	s=arc-20240116; t=1734528708; c=relaxed/simple;
	bh=Cdlpxn2g0zHBK+vfgMQnwWwfR+sZS1Q82AS7PPm/eSY=;
	h=Content-Type:Message-ID:Date:To:From:Subject:MIME-Version; b=Jr2wETwqKakDBCmsHsB9xt0JN7UDkqkEePf5d64Afo9G1+OYy7RHPbiFRH/UgDJfODEdRhpiCUsMrv/sJePYDPHt3L3fliKU0Ie+xQuyuAGFDoTiQbkWnpRe5TziF0bFH2akQp31kDHgQR3OqF7+m6bcfParBpi+Sg/Vk9f1/OY=
ARC-Authentication-Results:i=2; smtp.subspace.kernel.org; dmarc=pass (p=quarantine dis=none) header.from=viavisolutions.com; spf=pass smtp.mailfrom=viavisolutions.com; dkim=pass (1024-bit key) header.d=viavisolutions.com header.i=@viavisolutions.com header.b=EOBHIRhn; arc=fail smtp.client-ip=40.107.244.135
Authentication-Results: smtp.subspace.kernel.org; dmarc=pass (p=quarantine dis=none) header.from=viavisolutions.com
Authentication-Results: smtp.subspace.kernel.org; spf=pass smtp.mailfrom=viavisolutions.com
ARC-Seal: i=1; a=rsa-sha256; s=arcselector10001; d=microsoft.com; cv=none;
 b=tHBgc36TbiD5AA6bS0Eiyirc/34+sgFZO094ITZ4ZXUvdA/0A6frGtM3aqPjPX8H9Q/t5fz7VmWrW9LIwp7NHkrUAea7QmZyZaTo0NBJVcyIvq3cjnNkTmOmJsfhbzuMj7scJ9aH7cuTAxWdpoPHSUCh46pLxhf12BjkuOTtrxD54DeViRYBN/B3/GDuVhavoiLZ7hDRricGnYhc45vU24JXyqYx+IfjNjpny2b+asT5abCA/icxayDKKzHfUk7PuGC92FtA0iWWaU4LGRZT5j+lz5AktlUGGuyXC4rpb6O7Vx6X6UMZ3NEPB48WtwTr+mTX5vNMPKNtZ4gMosxmCA==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com;
 s=arcselector10001;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-AntiSpam-MessageData-ChunkCount:X-MS-Exchange-AntiSpam-MessageData-0:X-MS-Exchange-AntiSpam-MessageData-1;
 bh=NDPR1/jQ6Kz/P8//p5p+bOgAQZStF9cv0x3l+yi9FwE=;
 b=fysM2xEzeEpDE+I/qtlLmjCdJzwfrH8euV6wVfs8gPpVw8n2LE3PpE/6bscfjKJ8Xn0b5AiPP4kgA1jjKx3EFgvK78RdDJBPlKNUXIyx4qqJ+ZcEkLBKPecX7IqaNqmkEowH3bv3QLJLEGLhKrlO5n6DSrjtoJuKwR17Jbk50UGu7uNbb77N/8v+Yjnlpq/NlrQh/NZc7fvHkK/G+1vovNs7fkffP1PZkrjTPd3rFFHNcaDCmjhrRRZZBalMPlbiQuPwKsYwDa8firLsazQsfIkEYGrPC4G3RepujrS7VfbPInOw4oB+IPTIB3rjfkqk6VoLrsgyG0BqidhT+UelWQ==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=viavisolutions.com; dmarc=pass action=none
 header.from=viavisolutions.com; dkim=pass header.d=viavisolutions.com;
 arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=viavisolutions.com;
 s=selector1;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=NDPR1/jQ6Kz/P8//p5p+bOgAQZStF9cv0x3l+yi9FwE=;
 b=EOBHIRhnHc+nX+EpetMRTAArqY6hpgOhUQsyJA904NZjilOLsxvgzRu7F9Nnd9c/Dy9Hhx/H62uWHgXZDIuX88lkDGAaeux/nsVFRC3fWo+3CPVx9WSLGeSU64/42ShzpoLFOHdCDEd6nLE7dOYKM0yzrz6KZZ8xV+qfsmXlRyk=
Authentication-Results: dkim=none (message not signed)
 header.d=none;dmarc=none action=none header.from=viavisolutions.com;
Received: from PH0PR18MB4505.namprd18.prod.outlook.com (2603:10b6:510:e9::13)
 by SA1PR18MB4757.namprd18.prod.outlook.com (2603:10b6:806:1d8::21) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.8272.13; Wed, 18 Dec
 2024 13:31:44 +0000
Received: from PH0PR18MB4505.namprd18.prod.outlook.com
 ([fe80::29b1:816b:c99e:113f]) by PH0PR18MB4505.namprd18.prod.outlook.com
 ([fe80::29b1:816b:c99e:113f%5]) with mapi id 15.20.8272.005; Wed, 18 Dec 2024
 13:31:43 +0000
Content-Type: multipart/mixed; boundary="------------CWRqIyyln6zVDnTXsEB3geKn"
Message-ID: <aac3113c-36c8-4a97-b175-45e6e27c8431@viavisolutions.com>
Date: Wed, 18 Dec 2024 14:31:38 +0100
User-Agent: Mozilla Thunderbird
Content-Language: en-US
To: linux-sctp@vger.kernel.org
From: "Mihail D." <mihail.dakov@viavisolutions.com>
Subject: SCTP_AUTH_ACTIVE_KEY fails with Invalid Argument, how to?
X-ClientProxiedBy: VI1PR09CA0181.eurprd09.prod.outlook.com
 (2603:10a6:800:120::35) To PH0PR18MB4505.namprd18.prod.outlook.com
 (2603:10b6:510:e9::13)
Precedence: bulk
X-Mailing-List: linux-sctp@vger.kernel.org
List-Id: <linux-sctp.vger.kernel.org>
List-Subscribe: <mailto:linux-sctp+subscribe@vger.kernel.org>
List-Unsubscribe: <mailto:linux-sctp+unsubscribe@vger.kernel.org>
MIME-Version: 1.0
X-MS-PublicTrafficType: Email
X-MS-TrafficTypeDiagnostic: PH0PR18MB4505:EE_|SA1PR18MB4757:EE_
X-MS-Office365-Filtering-Correlation-Id: aab630f3-37f5-4150-923c-08dd1f684fa7
X-MS-Exchange-SenderADCheck: 1
X-MS-Exchange-AntiSpam-Relay: 0
X-Microsoft-Antispam: BCL:0;ARA:13230040|1800799024|376014|366016;
X-Microsoft-Antispam-Message-Info:
	=?utf-8?B?K1cweVd4OXFWNzUzdFF2dGQzaEtXeE5yTHFFR3E4aWRSVzBYTjhLSDJtWEVL?=
 =?utf-8?B?R3VpbDRsSzFNUXh4YS80d2UwZ3NjbHlPNU1VekQ3QjdHRkY1dlB6UlA0eUd5?=
 =?utf-8?B?NjZDM2RkeUhFQlhQUktlZUdQOWZIZ0ZzbnROSWdVcit0REpQYmxqSE45cE54?=
 =?utf-8?B?WDVCZ3Y4YXFWcnFRT29DeU1ONnY2bHAyd09uU2VYeWFXTU5pdGZ4cnQzUlVR?=
 =?utf-8?B?T08yZGlqM08wL051eFUxaHhJM1RtVzloNDZtMERtQkZXMnNlOEI1N2Nzajk0?=
 =?utf-8?B?bWxxbC9zY0VTdE5RQ1J6UjFlcElwWGFDcml3ZDR4d2U0eGg0eURyeXA2YndT?=
 =?utf-8?B?a3MrVVNuSjJQUVpaMmZtVHJ6TU9nOUlBSHZRc1VmNkdoNDZzWjZrNzRldHYy?=
 =?utf-8?B?WlFTNXg1cm5vMjVQSlpBeGZ6dC9MbVBHYTBKVFJuZ1pMaVNHYlF5QUU0bTlX?=
 =?utf-8?B?d2Q0aVNIZDFpUEROTHhFV2Z2blFkdUVsb3VFQVBuU2xPRU9SbmMrT0laemE4?=
 =?utf-8?B?dU11V3VBMWY5K0pQV05SNmJHYTl4bjE1emVML2VRYmR0MTRtOWtKSHI0OVVI?=
 =?utf-8?B?N0xlU1VjZUsvTWpyWHppd3U3c2FTS2RJZkdWSUhLMEVRdEljU1I0dEFZemNY?=
 =?utf-8?B?ZHVCQjlTNkdWT2gwVG1vTENCeGFURHJqV2E2UUpwMmtUQkF4UlRsRUd0Rzhi?=
 =?utf-8?B?RDVXWDExdExIWk95d1o4MExrUUw2MXQ4NjJOeTJxZkoyNC92bzlRbzNmYkxG?=
 =?utf-8?B?VjYzU25oOXNQdkx1dlFLOElINFpCSUxSWHBRUDB2R3Vock4rWEVMSS9SWnJr?=
 =?utf-8?B?eDBrMzhCRFhPSUp1R05aaW13NEdSRzNOakdOSnhhaHA3VjdmUWpjV2ZjUjN4?=
 =?utf-8?B?OHBzZzdZcy9jK2J5OFpjalhDMVZXeWtmcWkyZTNuVW0xZDNhWDIxZXc0R0Fu?=
 =?utf-8?B?SEdFdDVmRDNXbG5RQjFFcWFRUHplYTNQSHo3dXVCWmRySVdzRUpOS1d3U1V6?=
 =?utf-8?B?QmMwamxSNFE2bUxNVUU4UEx6Wm1YTFVmNzZXcjhvK3JnMHh3KzEyd2ZsTkxm?=
 =?utf-8?B?OXRUMUpaZVBRY2xqUnJjWFFvRlkrUG5XOHFvMVVzVGtXcGljT0NBTWYyS0hL?=
 =?utf-8?B?OWhlaUZuU1VOWkhkMm9COHgxeE9vVXM4UXA0czlNOCtIbzNFSVhhV1NaQ2d6?=
 =?utf-8?B?eW9hQVJhNUJlMXpHRVVnYU1US1g0ZWgyUFpiYzBTd3B2U0E4bTRyTzV3T1lq?=
 =?utf-8?B?UC9nMjV2blpaa1pMWEcwTzhBQnp2MlhzSlhwbDJWc1Y3cWxkMDZsNlgxNVBm?=
 =?utf-8?B?QitMMHpUakcxNXVtT3FxN1pkQVF2RjVldmZjMlBUMWNBVXFMSUtDQ1k4Yy9w?=
 =?utf-8?B?NFpqcEhoSld3Z05OVTIyS3k5TThHdklrRHpQT1p5QzRzVlIza0F1dnV2R09S?=
 =?utf-8?B?cndBV2pnT29yaVF6Y1pkMy9xYWJHZCtENFRYbWU0cUJxNHNRL2Vkeng1bi9h?=
 =?utf-8?B?N3JNTCszNDJaZXBlZ0J1WWtadCtFSEhBVDBYQVRyNDgzVnBYMWlCazRLTkxi?=
 =?utf-8?B?T09rYWZsODZCSzU4UFBBcUZGY0pJU1BkOTAwdXU0aHhpQmxuNTU2cEdHSUp4?=
 =?utf-8?B?Tk5EM0JQV0U0SXZmVDRwRG5YajkzbUpTcUJUZEVMcjFzQ1daM2JNSGZDN1hO?=
 =?utf-8?B?K2VjMWRmQlQ2S1UzOC9GNmRQMmJEWTJ1Wm1pQi9jZ3F5UEFhT1l3YWMwTVdL?=
 =?utf-8?B?ZjJhbFNHWCtWekNCMWxvUEZRcGVPSENGK2VQV0hQUnhTMnJoQU5QcDdXS0lP?=
 =?utf-8?B?c3p3OEgrMzdDRVVVdUJXY3V4RFFSeXJZZXdtNFpmZDdoQjdhUFVQNWxLY0pB?=
 =?utf-8?Q?Z6n/1Sn4/Wu9r?=
X-Forefront-Antispam-Report:
	CIP:255.255.255.255;CTRY:;LANG:en;SCL:1;SRV:;IPV:NLI;SFV:NSPM;H:PH0PR18MB4505.namprd18.prod.outlook.com;PTR:;CAT:NONE;SFS:(13230040)(1800799024)(376014)(366016);DIR:OUT;SFP:1102;
X-MS-Exchange-AntiSpam-MessageData-ChunkCount: 1
X-MS-Exchange-AntiSpam-MessageData-0:
	=?utf-8?B?ekhLNVphOXlJVTZxbnlPQ0FRRGJFaGpZZEU2OE5kb1RWUHh2K3ZNektwU29Y?=
 =?utf-8?B?cTBVZzJ0bVUrajRSM3FvMlRUVzl5N0tXQ1ZjcnFEbm0wS1k3UkxXQVZUUklS?=
 =?utf-8?B?aVRKRG45R0Fpc3QrWHJXUG9RbTJURzc4NGVhQTZyWG1VZkdlWlRzSU9yZVhO?=
 =?utf-8?B?WEVrdFFsOGNid0xrQ3FBVmZjMGw0R2J4WW40RU4vdUl2aENPNG52YjNSaTg2?=
 =?utf-8?B?SmFBRm52OWxEWUFVY3lLZDVlMlBDOElhZ28xd2JGaDVlaHR6bVRycFlTdzU0?=
 =?utf-8?B?QWRqRE50cTNvbUlXaDdFbCs4U3N2RHduU28xdklrWnc3ckgwTXJRMVI5VnVz?=
 =?utf-8?B?S3hYWGJjeno1cFFPelBEN2MydU5IQ0g0a3FrSUQwTnVFLzE1Z0x1M1FTbEY3?=
 =?utf-8?B?V0RjRHAwYkRYQmsvbXJjazAwcmRCbnVOWXd3eXJvUVlNYjZhb0wxZzRMMElL?=
 =?utf-8?B?ODRyZXhtQk96cTdOWHVLaFdjeG9xeXlDeTdMNHRGa1V6TTdONCtFSVBlL21G?=
 =?utf-8?B?MHFxRDJ5VTFZMjJTZ2x3Y05TeG5Falp1NVJBN2VBZ1VYa3A4SXZpOEU3aTh0?=
 =?utf-8?B?NFd2czdZa04rR0VqUHcxczNQODZWUjJ4K0loVDNjaWlmQncvY3dMcnJQMEZP?=
 =?utf-8?B?akV0TTJpa1QveFF1VGhUVXZwbm5mSzNnS041Q3g4K0pMVkNKbEJKNjRYU2Mz?=
 =?utf-8?B?N25lUDR2SmppRDA4bytjajBkTWVjaGprempRUzN3dUpUSnFsRzJOSXNrNmlB?=
 =?utf-8?B?VksxSVB1bGRwZkRLL1NFVWY1YkNJSS91RDJFQUNSdFBVb2ZLaW1XSDlNZXlI?=
 =?utf-8?B?ZUhSN3JtMjJpbkdCSlVvNEc4M0R2eVBsQklwN3NXNDRTTm5QakJGRmpMejFw?=
 =?utf-8?B?eEtHd2wxUEt4Ymk3QXBySnpvSDVkQkVqZGlpa2RBOVpLeTRNdFdhalNKNjV6?=
 =?utf-8?B?anBKT0F4dmJIZGhMRjRsMkp6bktZM2ZqNHI2bFRxSjhEUGgxYTRzSVBkZk8v?=
 =?utf-8?B?ZDVRQU1JdkxBZlBVbytXR0ZBNkoxNXJWOUhPTkgya0gvcGhBb2lXakNNMmk3?=
 =?utf-8?B?RVgwQWtYc1UzRGxBdE83QVgvUEpWSmk1V1ZzbXhWcEZTNnh6NWpoVWplVUFI?=
 =?utf-8?B?S0R0MC9CS1l0TlJMR3d4RHJkMUFTNU1jNG9ISkNpbTlMMk5Vc2NTUWE2U2k1?=
 =?utf-8?B?Q251ZHd5Q1FmY0VFanZWeDBaTmhLZ3RhOXVCWUpmcnZUNktkQjZOdDd2TFBD?=
 =?utf-8?B?ZTdXQVVveHM0SUg2R2s5QnEzdlVySUluRS9BSmlpU1VXYWZnWnk0VFExVFha?=
 =?utf-8?B?NjdUajNsMEtpOGQvU2RLYzFLejFPRTNPamwvLzNLZXkxVEkrTHRIYlJFcERP?=
 =?utf-8?B?QTRmN05iMExaWlJZRE9hZXFOR2VBN1FmTU4yQ1ZjRUxyVzlGOVNXd0krcGNU?=
 =?utf-8?B?OFk3Rlppd25aSzRrWGoxWnlzQ1N3aDd0WEk2LzJLRVNpYkYveEVNeWlLT0FN?=
 =?utf-8?B?aGZqODVOaTl4MW5RYTdWQk1iVGRHbGZ4clZ6NVVuNXYvT21PRmMxUnVmZXMx?=
 =?utf-8?B?WWRFcEllR1UxeWdiRTN1WHVIZVptRzlla21kRENkVmdoMHN3ZFpYSGV6cnov?=
 =?utf-8?B?QjE4RzhjamZ6WDFQSnJtcTZyTXZrcERpeFIyUTVkY1plZWZDQnNjUDI4SGNV?=
 =?utf-8?B?Z2FFSzJORVlaWUJ1V2VGSnZpWWlZczY3b3c2ZDhiUEt3MlEzczNwbFZEOExV?=
 =?utf-8?B?RnVzS1lud1BQR1g4T2FmQ3oxYWRvcTFiL1JOdHArVUduKzlMYmVqZHpCblA5?=
 =?utf-8?B?aFhQMXN6eEZYcWhTU0JReTBSUUhUc3JXcVFmUFZPUVRtZlU4NVVZc0txeVo3?=
 =?utf-8?B?WjJtR09tWHhUeHNBQUZQQVlkdEYyb0N2UzJ4TUlMam11cXNHL2RrR1plZVBZ?=
 =?utf-8?B?ZERMQ3ZnOUNtUzZTQmJxRjVYaDFxWXlpVnZ3ZXJrazRKb2ttR0pac2hBL2xq?=
 =?utf-8?B?SnQ4cnYzdWMvSFE1b0pzdEZxODZYQmR2UWpVZ05tOFE3d2J5b3hvU3F6dW91?=
 =?utf-8?B?dzlTcDVmQWlKQ2htNUdhMWp1ZG91K21yRkd1UWNmMjc3Snd0aUJSeGh2eVU4?=
 =?utf-8?B?WnRIZ2JjR2sxa2lJU0VMQnFMYVZmQ01KUjBDZ29RT1g0R21qczhzZ2xCQWtK?=
 =?utf-8?B?OGc9PQ==?=
X-OriginatorOrg: viavisolutions.com
X-MS-Exchange-CrossTenant-Network-Message-Id: aab630f3-37f5-4150-923c-08dd1f684fa7
X-MS-Exchange-CrossTenant-AuthSource: PH0PR18MB4505.namprd18.prod.outlook.com
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 18 Dec 2024 13:31:43.4680
 (UTC)
X-MS-Exchange-CrossTenant-FromEntityHeader: Hosted
X-MS-Exchange-CrossTenant-Id: c44ec86f-d007-4b6c-8795-8ea75e4a6f9b
X-MS-Exchange-CrossTenant-MailboxType: HOSTED
X-MS-Exchange-CrossTenant-UserPrincipalName: wFGhpGYeoXMw2YQ+RhyqUNMXFIxa+AiEnl7Wx5r6V+ff0zJQHZAhxt5jcFpeO4EdTbE7B8rpqF83rDOVVqyTugscmDYjYoHehINtVv63+L8=
X-MS-Exchange-Transport-CrossTenantHeadersStamped: SA1PR18MB4757

--------------CWRqIyyln6zVDnTXsEB3geKn
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit

Good Day,

I am trying to enable the RFC 4895 sctp-auth extension in our 
communications framework. For this goal I am using standard linux 
sockets options, setting SCTP_AUTH_XXXX options to my client and server 
sockets.

The problem I have is when using endpoint shared keys. Although I am 
able to install it via SCTP_AUTH_KEY option I am NOT able to activate it 
via SCTP_AUTH_ACTIVE_KEY. I have tried multiple times setting the option 
at different points of time but I still get the "Invalid Argument" error.

I have created a minimal example where I can reproduce the problem in 
question. Note that I have not payed much attention to the correct tx 
and rx paths since the example is enough to illustrate the problem. I 
have some pcaps as well to understand what goes into the wire. In the 
one, and only, message that sends the client, I can see that in the 
shared key id field, AUTH chunk, 0 is being used which means no shared 
key. What I would like to have is to activate my shared key. 
Unfortunately I did not find a way to verify which shared key is being 
used except the field in AUTH chunk.

I have also tried tried use sendmsg() sys call with control data setting 
SCTP_AUTHINFO but it also does not work so I am out of ideas.

How exactly do I activate an endpoint shared key?

P.S. See attached utils.

--------------CWRqIyyln6zVDnTXsEB3geKn
Content-Type: text/x-c++src; charset=UTF-8; name="client.cpp"
Content-Disposition: attachment; filename="client.cpp"
Content-Transfer-Encoding: base64

I2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlIDxzdGRsaWIuaD4KI2luY2x1ZGUgPHN0cmluZy5o
PgojaW5jbHVkZSA8c3lzL3NvY2tldC5oPgojaW5jbHVkZSA8bmV0aW5ldC9pbi5oPgojaW5jbHVk
ZSA8YXJwYS9pbmV0Lmg+CiNpbmNsdWRlIDxuZXRpbmV0L3NjdHAuaD4KI2luY2x1ZGUgPHVuaXN0
ZC5oPgojaW5jbHVkZSA8ZmNudGwuaD4KCiNkZWZpbmUgUkVDVkJVRlNJWkUgMjA0OAoKCmludCBt
YWluKCkgewogICAgY2hhciBtZXNzYWdlW10gPSB7ImhlbGxvIn07CgogICAgaW50IHNkID0gc29j
a2V0KEFGX0lORVQsIFNPQ0tfU1RSRUFNLCBJUFBST1RPX1NDVFApOwogICAgaWYoc2QgPT0gLTEp
IHsKICAgICAgICBwZXJyb3IoImZhaWx1cmUgb3BlbmluZyBzb2NrZXQiKTsKICAgICAgICBleGl0
KEVYSVRfRkFJTFVSRSk7CiAgICB9CgogICAgewogICAgICBpbnQgb24gPSAxOwogICAgICBpZiAo
c2V0c29ja29wdChzZCwgSVBQUk9UT19TQ1RQLCBTQ1RQX05PREVMQVksICZvbiwgc2l6ZW9mKG9u
KSkgPCAwKSB7CiAgICAgICAgcGVycm9yKCJmYWlsIHRvIHNldCBTQ1RQX05PREVMQVkiKTsKICAg
ICAgICBleGl0KEVYSVRfRkFJTFVSRSk7CiAgICAgIH0KICAgIH0KCiAgICB7CiAgICAgIHNjdHBf
aW5pdG1zZyBpbml0bXNnOwogICAgICBpbml0bXNnLnNpbml0X251bV9vc3RyZWFtcyAgID0gMjsK
ICAgICAgaW5pdG1zZy5zaW5pdF9tYXhfaW5zdHJlYW1zICA9IDI7CiAgICAgIGluaXRtc2cuc2lu
aXRfbWF4X2F0dGVtcHRzICAgPSAxMDsKICAgICAgaW5pdG1zZy5zaW5pdF9tYXhfaW5pdF90aW1l
byA9IDEwMDA7CiAgICAgIGlmIChzZXRzb2Nrb3B0KHNkLCBJUFBST1RPX1NDVFAsIFNDVFBfSU5J
VE1TRywgJmluaXRtc2csIHNpemVvZihpbml0bXNnKSkgPCAwKSB7CiAgICAgICAgcGVycm9yKCJm
YWlsIHRvIHNldCBTQ1RQX0lOSVRNU0ciKTsKICAgICAgICBleGl0KEVYSVRfRkFJTFVSRSk7CiAg
ICAgIH0KICAgIH0KCiAgICB7CiAgICAgIGludCBmbGFnczsKICAgICAgaWYgKChmbGFncyA9IGZj
bnRsKHNkLCBGX0dFVEZMLCAwKSkgPCAwKSB7CiAgICAgICAgcGVycm9yKCJmYWlsIHRvIGdldCBm
bGFncyIpOwogICAgICAgIGV4aXQoRVhJVF9GQUlMVVJFKTsKICAgICAgfQogICAgICBmbGFncyB8
PSBTT0NLX05PTkJMT0NLOwogICAgICBpZiAoZmNudGwoc2QsIEZfU0VURkwsIDApIDwgMCkgewog
ICAgICAgIHBlcnJvcigiZmFpbCB0byBzZXQgZmxhZ3MiKTsKICAgICAgICBleGl0KEVYSVRfRkFJ
TFVSRSk7CiAgICAgIH0KICAgIH0KCiAgICB7CiAgICAgIGludCBmbGFnczsKICAgICAgaWYgKChm
bGFncyA9IGZjbnRsKHNkLCBGX0dFVEZMLCAwKSkgPCAwKSB7CiAgICAgICAgcGVycm9yKCJmYWls
IHRvIGdldCBmbGFncyIpOwogICAgICAgIGV4aXQoRVhJVF9GQUlMVVJFKTsKICAgICAgfQogICAg
ICBmbGFncyB8PSBTT0NLX05PTkJMT0NLOwogICAgICBpZiAoZmNudGwoc2QsIEZfU0VURkwsIDAp
IDwgMCkgewogICAgICAgIHBlcnJvcigiZmFpbCB0byBzZXQgZmxhZ3MiKTsKICAgICAgICBleGl0
KEVYSVRfRkFJTFVSRSk7CiAgICAgIH0KICAgIH0KCiAgICB7CiAgICAgIHN0cnVjdCBzY3RwX2Fz
c29jX3ZhbHVlIGFzc29fYXV0aF9vcHQ7CiAgICAgIGFzc29fYXV0aF9vcHQuYXNzb2NfaWQgICAg
PSBTQ1RQX0ZVVFVSRV9BU1NPQzsKICAgICAgYXNzb19hdXRoX29wdC5hc3NvY192YWx1ZSA9IHNk
OwogICAgICBpZiAoc2V0c29ja29wdChzZCwgU09MX1NDVFAsIFNDVFBfQVVUSF9TVVBQT1JURUQs
CiAgICAgICAgICAgICAgICAgICAgICZhc3NvX2F1dGhfb3B0LCBzaXplb2YoYXNzb19hdXRoX29w
dCkpIDwgMCkgewogICAgICAgIHBlcnJvcigiZmFpbCB0byBzZXQgU0NUUF9BVVRIX1NVUFBPUlRF
RCIpOwogICAgICAgIGV4aXQoRVhJVF9GQUlMVVJFKTsKICAgICAgfQoKICAgICAgc3RydWN0IHNj
dHBfYXV0aGNodW5rIGRhdGFjaHVua3R5cGU7CiAgICAgIGRhdGFjaHVua3R5cGUuc2F1dGhfY2h1
bmsgPSAwOwogICAgICBpZiAoc2V0c29ja29wdChzZCwgU09MX1NDVFAsIFNDVFBfQVVUSF9DSFVO
SywKICAgICAgICAgICAgICAgICAgICAgJmRhdGFjaHVua3R5cGUsIHNpemVvZihzY3RwX2F1dGhj
aHVuaykpIDwgMCkgewogICAgICAgIHBlcnJvcigiZmFpbCB0byBzZXQgU0NUUF9BVVRIX0NIVU5L
Iik7CiAgICAgICAgZXhpdChFWElUX0ZBSUxVUkUpOwogICAgICB9CgogICAgICB1aW50OF90IG51
bWhtYWNzID0gMjsKICAgICAgdWludDMyX3QgaG1hY2J1ZmxlbiA9IHNpemVvZihzY3RwX2htYWNh
bGdvKSArIChudW1obWFjcyAqIHNpemVvZih1aW50MTZfdCkpOwogICAgICBjaGFyIGhtYWNidWZb
aG1hY2J1Zmxlbl07CiAgICAgIHN0cnVjdCBzY3RwX2htYWNhbGdvICpvcHRobWFjID0gKHN0cnVj
dCBzY3RwX2htYWNhbGdvICopIGhtYWNidWY7CiAgICAgIG9wdGhtYWMtPnNobWFjX251bV9pZGVu
dHMgPSBudW1obWFjczsKICAgICAgb3B0aG1hYy0+c2htYWNfaWRlbnRzWzBdID0gU0NUUF9BVVRI
X0hNQUNfSURfU0hBMjU2OwogICAgICBvcHRobWFjLT5zaG1hY19pZGVudHNbMV0gPSBTQ1RQX0FV
VEhfSE1BQ19JRF9TSEExOwogICAgICBpZiAoc2V0c29ja29wdChzZCwgU09MX1NDVFAsIFNDVFBf
SE1BQ19JREVOVCwKICAgICAgICAgICAgICAgICAgICAgb3B0aG1hYywgaG1hY2J1ZmxlbikgPCAw
KSB7CiAgICAgICAgcGVycm9yKCJmYWlsIHRvIHNldCBTQ1RQX0hNQUNfSURFTlQiKTsKICAgICAg
ICBleGl0KEVYSVRfRkFJTFVSRSk7CiAgICAgIH0KCiNpZiAxCiAgICAgIGludCBrZXlsZW4gPSA1
OwogICAgICB1aW50MzJfdCBrZXlidWZsZW4gPSBrZXlsZW4gKyBzaXplb2Yoc2N0cF9hdXRoa2V5
KTsKICAgICAgY2hhciBrZXlidWZba2V5YnVmbGVuXTsKICAgICAgc3RydWN0IHNjdHBfYXV0aGtl
eSAqb3B0X2tleSA9IChzdHJ1Y3Qgc2N0cF9hdXRoa2V5ICopa2V5YnVmOwogICAgICBvcHRfa2V5
LT5zY2FfYXNzb2NfaWQgID0gU0NUUF9GVVRVUkVfQVNTT0M7IC8vIGZvciB0Y3Agc3R5bGUgdGhp
cyBpcyBpZ25vcmVkLiBzZXQgc29tZXRoaW5nCiAgICAgIG9wdF9rZXktPnNjYV9rZXlsZW5ndGgg
PSBrZXlsZW47CiAgICAgIG9wdF9rZXktPnNjYV9rZXludW1iZXIgPSAxOwogICAgICBtZW1jcHko
b3B0X2tleS0+c2NhX2tleSwgIm15a2V5Iiwga2V5bGVuKTsKICAgICAgaWYgKHNldHNvY2tvcHQo
c2QsIFNPTF9TQ1RQLCBTQ1RQX0FVVEhfS0VZLAogICAgICAgICAgICAgICAgICAgICAmb3B0X2tl
eSwga2V5YnVmbGVuKSA8IDApIHsKICAgICAgICBwZXJyb3IoImZhaWwgdG8gc2V0IFNDVFBfQVVU
SF9LRVkiKTsKICAgICAgICBleGl0KEVYSVRfRkFJTFVSRSk7CiAgICAgIH0KI2VuZGlmCgojaWYg
MAogICAgICAgIHN0cnVjdCBzY3RwX2F1dGhrZXlpZCBhY3RrZXk7CiAgICAgICAgYWN0a2V5LnNj
YWN0X2Fzc29jX2lkICA9IFNDVFBfRlVUVVJFX0FTU09DOyAvLyBmb3IgdGNwIHN0eWxlIHRoaXMg
aXMgaWdub3JlZC4gc2V0IHNvbWV0aGluZwogICAgICAgIGFjdGtleS5zY2FjdF9rZXludW1iZXIg
PSAxOwogICAgICAgIGlmIChzZXRzb2Nrb3B0KHNkLCBTT0xfU0NUUCwgU0NUUF9BVVRIX0FDVElW
RV9LRVksCiAgICAgICAgICAgICAgICAgICAgICAgJmFjdGtleSwgc2l6ZW9mKHNjdHBfYXV0aGtl
eWlkKSkgPCAwKSB7CiAgICAgICAgICAgIHBlcnJvcigiZmFpbCB0byBzZXQgU0NUUF9BVVRIX0FD
VElWRV9LRVkiKTsKICAgICAgICAgICAgZXhpdChFWElUX0ZBSUxVUkUpOwogICAgICAgIH0KI2Vu
ZGlmCiAgICB9CgogICAgewogICAgICBpbnQgb24gPSAxOwogICAgICBpZiAoc2V0c29ja29wdChz
ZCwgU09MX1NPQ0tFVCwgU09fUkVVU0VBRERSLCAmb24sIHNpemVvZihvbikpIDwgMCkgewogICAg
ICAgIHBlcnJvcigiZmFpbCB0byBzZXQgU09fUkVVU0VBRERSIik7CiAgICAgICAgZXhpdChFWElU
X0ZBSUxVUkUpOwogICAgICB9CiAgICB9CgogICAgewogICAgICBpbnQgb24gPSAxOwogICAgICBp
ZiAoc2V0c29ja29wdChzZCwgU09MX1NPQ0tFVCwgU09fUkVVU0VQT1JULCAmb24sIHNpemVvZihv
bikpIDwgMCkgewogICAgICAgIHBlcnJvcigiZmFpbCB0byBzZXQgU09fUkVVU0VQT1JUIik7CiAg
ICAgICAgZXhpdChFWElUX0ZBSUxVUkUpOwogICAgICB9CiAgICB9CgogICAgc3RydWN0IHNvY2th
ZGRyX2luIGFkZHJlc3M7CiAgICBiemVybygodm9pZCopJmFkZHJlc3MsIHNpemVvZihhZGRyZXNz
KSk7CiAgICBhZGRyZXNzLnNpbl9mYW1pbHkgPSBBRl9JTkVUOwogICAgYWRkcmVzcy5zaW5fcG9y
dCA9IGh0b25zKDE0MjQyKTsKICAgIGFkZHJlc3Muc2luX2FkZHIuc19hZGRyID0gaW5ldF9hZGRy
KCIxMjcuMC4wLjEiKTsKCiAgICBpbnQgcmIgPSBiaW5kKHNkLCAoc3RydWN0IHNvY2thZGRyICop
JmFkZHJlc3MsIHNpemVvZihhZGRyZXNzKSk7CiAgICBpZihyYiA9PSAtMSkgewogICAgICAgIHBl
cnJvcigiYmluZCBlcnJvciIpOwogICAgICAgIGNsb3NlKHNkKTsKICAgICAgICBleGl0KEVYSVRf
RkFJTFVSRSk7CiAgICB9CgojaWYgMAogICAgICAgIHN0cnVjdCBzY3RwX2F1dGhrZXlpZCBhY3Rr
ZXk7CiAgICAgICAgYWN0a2V5LnNjYWN0X2Fzc29jX2lkICA9IFNDVFBfRlVUVVJFX0FTU09DOyAv
LyBmb3IgdGNwIHN0eWxlIHRoaXMgaXMgaWdub3JlZC4gc2V0IHNvbWV0aGluZwogICAgICAgIGFj
dGtleS5zY2FjdF9rZXludW1iZXIgPSAxOwogICAgICAgIGlmIChzZXRzb2Nrb3B0KHNkLCBTT0xf
U0NUUCwgU0NUUF9BVVRIX0FDVElWRV9LRVksCiAgICAgICAgICAgICAgICAgICAgICAgJmFjdGtl
eSwgc2l6ZW9mKHNjdHBfYXV0aGtleWlkKSkgPCAwKSB7CiAgICAgICAgICAgIHBlcnJvcigiZmFp
bCB0byBzZXQgU0NUUF9BVVRIX0FDVElWRV9LRVkiKTsKICAgICAgICAgICAgZXhpdChFWElUX0ZB
SUxVUkUpOwogICAgICAgIH0KI2VuZGlmCgogICAgaW50IHJldCA9IGNvbm5lY3Qoc2QsIChzb2Nr
YWRkciAqKSZhZGRyZXNzLCBzaXplb2YoYWRkcmVzcykpOwogICAgaWYgKHJldCA8IDApCiAgICB7
CiAgICAgICAgcGVycm9yKCJmYWlsIHRvIGNvbm5lY3QiKTsKICAgICAgICBjbG9zZShzZCk7CiAg
ICAgICAgZXhpdChFWElUX0ZBSUxVUkUpOwogICAgfQoKI2lmIDAKICAgICAgICBzdHJ1Y3Qgc2N0
cF9hdXRoa2V5aWQgYWN0a2V5OwogICAgICAgIGFjdGtleS5zY2FjdF9hc3NvY19pZCAgPSBTQ1RQ
X0ZVVFVSRV9BU1NPQzsgLy8gZm9yIHRjcCBzdHlsZSB0aGlzIGlzIGlnbm9yZWQuIHNldCBzb21l
dGhpbmcKICAgICAgICBhY3RrZXkuc2NhY3Rfa2V5bnVtYmVyID0gMTsKICAgICAgICBpZiAoc2V0
c29ja29wdChzZCwgU09MX1NDVFAsIFNDVFBfQVVUSF9BQ1RJVkVfS0VZLAogICAgICAgICAgICAg
ICAgICAgICAgICZhY3RrZXksIHNpemVvZihzY3RwX2F1dGhrZXlpZCkpIDwgMCkgewogICAgICAg
ICAgICBwZXJyb3IoImZhaWwgdG8gc2V0IFNDVFBfQVVUSF9BQ1RJVkVfS0VZIik7CiAgICAgICAg
ICAgIGV4aXQoRVhJVF9GQUlMVVJFKTsKICAgICAgICB9CiNlbmRpZgoKICAgIHNjdHBfZXZlbnRf
c3Vic2NyaWJlIGV2ZW50cyA9IHswfTsKICAgIGV2ZW50cy5zY3RwX2Fzc29jaWF0aW9uX2V2ZW50
ID0gMTsKICAgIGV2ZW50cy5zY3RwX2RhdGFfaW9fZXZlbnQgICAgID0gMTsKICAgIGV2ZW50cy5z
Y3RwX3NodXRkb3duX2V2ZW50ICAgID0gMTsKICAgIGV2ZW50cy5zY3RwX3BlZXJfZXJyb3JfZXZl
bnQgID0gMTsKICAgIGlmIChzZXRzb2Nrb3B0KHNkLCBJUFBST1RPX1NDVFAsIFNDVFBfRVZFTlRT
LAogICAgICAgICAgICAgICAgICZldmVudHMsIHNpemVvZihldmVudHMpKSA8IDApIHsKICAgICAg
ICBwZXJyb3IoImZhaWwgdG8gc2V0IFNDVFBfRVZFTlRTIik7CiAgICAgICAgZXhpdChFWElUX0ZB
SUxVUkUpOwogICAgfQoKICAgIHNjdHBfcGFkZHJwYXJhbXMgaGVhcnRiZWF0cyA9IHswfTsKICAg
IGhlYXJ0YmVhdHMuc3BwX2ZsYWdzICAgICAgPSBTUFBfSEJfRU5BQkxFIHwgU1BQX1BNVFVEX0RJ
U0FCTEU7CiAgICBoZWFydGJlYXRzLnNwcF9oYmludGVydmFsID0gNTAwMDsKICAgIGhlYXJ0YmVh
dHMuc3BwX3BhdGhtYXhyeHQgPSAxOwogICAgaWYgKHNldHNvY2tvcHQoc2QsIFNPTF9TQ1RQLCBT
Q1RQX1BFRVJfQUREUl9QQVJBTVMsCiAgICAgICAgICAgICAgICAgJmhlYXJ0YmVhdHMsIHNpemVv
ZihoZWFydGJlYXRzKSkgPCAwKSB7CiAgICAgICAgcGVycm9yKCJmYWlsIHRvIHNldCBTQ1RQX0VW
RU5UUyIpOwogICAgICAgIGV4aXQoRVhJVF9GQUlMVVJFKTsKICAgIH0KCiAgICBzY3RwX3J0b2lu
Zm8gcnRvaW5mbyA9IHswfTsKICAgIGludCBzY3RwcnRvID0gMjAwOwogICAgcnRvaW5mby5zcnRv
X21pbiAgICAgPSBzY3RwcnRvOwogICAgcnRvaW5mby5zcnRvX21heCAgICAgPSAyICogc2N0cHJ0
bzsKICAgIHJ0b2luZm8uc3J0b19pbml0aWFsID0gKDMqc2N0cHJ0bykvMjsKICAgIGlmIChzZXRz
b2Nrb3B0KHNkLCBJUFBST1RPX1NDVFAsIFNDVFBfUlRPSU5GTywKICAgICAgICAgICAgICAgICAm
cnRvaW5mbywgc2l6ZW9mKHJ0b2luZm8pKSA8IDApIHsKICAgICAgICBwZXJyb3IoImZhaWwgdG8g
c2V0IFNDVFBfRVZFTlRTIik7CiAgICAgICAgZXhpdChFWElUX0ZBSUxVUkUpOwogICAgfQoKICAg
IGludCBzZW50OwoKI2lmIDAKICAgIHN0cnVjdCBtc2doZHIgbXNnID0gezB9OwoKICAgIHN0cnVj
dCBpb3ZlYyBkYXRhdjsKICAgIGRhdGF2Lmlvdl9iYXNlID0gbWVzc2FnZTsKICAgIGRhdGF2Lmlv
dl9sZW4gID0gc2l6ZW9mKG1lc3NhZ2UpOwogICAgbXNnLm1zZ19pb3ZsZW4gPSAxOwogICAgbXNn
Lm1zZ19pb3YgICAgPSAmZGF0YXY7CgogICAgY2hhciBjdHJsYnVmW0NNU0dfU1BBQ0Uoc2l6ZW9m
KHNjdHBfc25kcmN2aW5mbykpICsKICAgICAgICAgICAgICAgICBDTVNHX1NQQUNFKHNpemVvZihz
Y3RwX2F1dGhpbmZvKSldOwoKICAgIG1zZy5tc2dfY29udHJvbCAgICA9IGN0cmxidWY7CiAgICBt
c2cubXNnX2NvbnRyb2xsZW4gPSBzaXplb2YoY3RybGJ1Zik7CgogICAgc3RydWN0IGNtc2doZHIg
KnBjbXNnID0gQ01TR19GSVJTVEhEUigmbXNnKTsKICAgIHBjbXNnLT5jbXNnX2xlbiAgICA9IENN
U0dfTEVOKHNpemVvZihzY3RwX3NuZHJjdmluZm8pKTsKICAgIHBjbXNnLT5jbXNnX2xldmVsICA9
IFNPTF9TQ1RQOwogICAgcGNtc2ctPmNtc2dfdHlwZSAgID0gU0NUUF9TTkRSQ1Y7CgogICAgc3Ry
dWN0IHNjdHBfc25kcmN2aW5mbyAqc3JpbmZvID0gKHN0cnVjdCBzY3RwX3NuZHJjdmluZm8gKikg
Q01TR19EQVRBKHBjbXNnKTsKICAgIHNyaW5mby0+c2luZm9fc3RyZWFtID0gMDsKICAgIHNyaW5m
by0+c2luZm9fcHBpZCAgID0gMTE7CgogICAgcGNtc2cgPSBDTVNHX05YVEhEUigmbXNnLCBwY21z
Zyk7CiAgICBwY21zZy0+Y21zZ19sZW4gICAgPSBDTVNHX0xFTihzaXplb2Yoc2N0cF9hdXRoaW5m
bykpOwogICAgcGNtc2ctPmNtc2dfbGV2ZWwgID0gU09MX1NDVFA7CiAgICBwY21zZy0+Y21zZ190
eXBlICAgPSBTQ1RQX0FVVEhJTkZPOwogICAgc3RydWN0IHNjdHBfYXV0aGluZm8gKmF1dGhpbmZv
ID0gKHN0cnVjdCBzY3RwX2F1dGhpbmZvICopIENNU0dfREFUQShwY21zZyk7CiAgICBhdXRoaW5m
by0+YXV0aF9rZXludW1iZXIgPSAxOwoKICAgIGlmICgoc2VudCA9IHNlbmRtc2coc2QsICZtc2cs
IE1TR19ET05UV0FJVCkpIDw9IDApCiAgICB7CiAgICAgICAgcGVycm9yKCJmYWlsIHRvIHNlbmRt
c2ciKTsKI2Vsc2UKICAgIHNjdHBfc25kcmN2aW5mbyBzaW5mbyA9IHswfTsKICAgIHNpbmZvLnNp
bmZvX3BwaWQgPSAxMTsKICAgIHNpbmZvLnNpbmZvX3N0cmVhbSA9IDA7CiAgICBpZiAoKHNlbnQg
PSBzY3RwX3NlbmQoc2QsIG1lc3NhZ2UsIHNpemVvZihtZXNzYWdlKSwgJnNpbmZvLCAwKSkgPD0g
MCkKICAgIHsKICAgICAgICBwZXJyb3IoImZhaWwgdG8gc2N0cF9zZW5kIik7CiNlbmRpZgogICAg
ICAgIGV4aXQoRVhJVF9GQUlMVVJFKTsKICAgIH0KCiAgICBmcHJpbnRmKHN0ZG91dCwgInNlbnQg
JXMvJWRcbiIsIG1lc3NhZ2UsIHNlbnQpOwoKICAgIGNsb3NlKHNkKTsKCiAgICByZXR1cm4gRVhJ
VF9TVUNDRVNTOwp9Cgo=

--------------CWRqIyyln6zVDnTXsEB3geKn
Content-Type: application/x-pcapng; name="sctp-auth-default-ok.pcapng"
Content-Disposition: attachment; filename="sctp-auth-default-ok.pcapng"
Content-Transfer-Encoding: base64

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
AAAAAABsAAAA

--------------CWRqIyyln6zVDnTXsEB3geKn
Content-Type: application/x-pcapng; name="sctp-auth-share-key-fail-1.pcapng"
Content-Disposition: attachment; filename="sctp-auth-share-key-fail-1.pcapng"
Content-Transfer-Encoding: base64

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

--------------CWRqIyyln6zVDnTXsEB3geKn
Content-Type: application/x-pcapng; name="sctp-auth-share-key-fail-2.pcapng"
Content-Disposition: attachment; filename="sctp-auth-share-key-fail-2.pcapng"
Content-Transfer-Encoding: base64

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

--------------CWRqIyyln6zVDnTXsEB3geKn
Content-Type: text/x-c++src; charset=UTF-8; name="server.cpp"
Content-Disposition: attachment; filename="server.cpp"
Content-Transfer-Encoding: base64

I2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlIDxzdGRsaWIuaD4KI2luY2x1ZGUgPHN0cmluZy5o
PgojaW5jbHVkZSA8c3lzL3R5cGVzLmg+CiNpbmNsdWRlIDxzeXMvc29ja2V0Lmg+CiNpbmNsdWRl
IDxhcnBhL2luZXQuaD4KI2luY2x1ZGUgPG5ldGluZXQvc2N0cC5oPgojaW5jbHVkZSA8dW5pc3Rk
Lmg+CiNpbmNsdWRlIDxlcnJuby5oPgojaW5jbHVkZSA8ZmNudGwuaD4KCiNkZWZpbmUgUkVDVkJV
RlNJWkUgMjA0OAoKaW50IG1haW4oKSB7CgogICAgaW50IHNkOwoKICAgIHNkID0gc29ja2V0KFBG
X0lORVQsIFNPQ0tfU1RSRUFNLCBJUFBST1RPX1NDVFApOwoKICAgIGlmKHNkID09IC0xKSB7CiAg
ICAgICAgcGVycm9yKCJmYWlsdXJlIG9wZW5pbmcgc29ja2V0Iik7CiAgICAgICAgZXhpdChFWElU
X0ZBSUxVUkUpOwogICAgfQoKICAgIHN0cnVjdCBzb2NrYWRkcl9pbiBzZXJ2ZXJBZGRyZXNzOwog
ICAgYnplcm8oKHZvaWQgKikmc2VydmVyQWRkcmVzcywgc2l6ZW9mKHNlcnZlckFkZHJlc3MpKTsK
ICAgIHNlcnZlckFkZHJlc3Muc2luX2ZhbWlseSA9IEFGX0lORVQ7CiAgICBzZXJ2ZXJBZGRyZXNz
LnNpbl9hZGRyLnNfYWRkciA9IGh0b25sKDB4N2YwMDAwMDEpOwogICAgc2VydmVyQWRkcmVzcy5z
aW5fcG9ydCA9IGh0b25zKDE0MjQyKTsKCiAgICB7CiAgICAgIGludCBvbiA9IDE7CiAgICAgIGlm
IChzZXRzb2Nrb3B0KHNkLCBJUFBST1RPX1NDVFAsIFNDVFBfTk9ERUxBWSwgJm9uLCBzaXplb2Yo
b24pKSA8IDApIHsKICAgICAgICBwZXJyb3IoImZhaWwgdG8gc2V0IFNDVFBfTk9ERUxBWSIpOwog
ICAgICAgIGV4aXQoRVhJVF9GQUlMVVJFKTsKICAgICAgfQogICAgfQoKICAgIHsKICAgICAgc2N0
cF9pbml0bXNnIGluaXRtc2c7CiAgICAgIGluaXRtc2cuc2luaXRfbnVtX29zdHJlYW1zICAgPSAy
OwogICAgICBpbml0bXNnLnNpbml0X21heF9pbnN0cmVhbXMgID0gMjsKICAgICAgaW5pdG1zZy5z
aW5pdF9tYXhfYXR0ZW1wdHMgICA9IDEwOwogICAgICBpbml0bXNnLnNpbml0X21heF9pbml0X3Rp
bWVvID0gMTAwMDsKICAgICAgaWYgKHNldHNvY2tvcHQoc2QsIElQUFJPVE9fU0NUUCwgU0NUUF9J
TklUTVNHLCAmaW5pdG1zZywgc2l6ZW9mKGluaXRtc2cpKSA8IDApIHsKICAgICAgICBwZXJyb3Io
ImZhaWwgdG8gc2V0IFNDVFBfSU5JVE1TRyIpOwogICAgICAgIGV4aXQoRVhJVF9GQUlMVVJFKTsK
ICAgICAgfQogICAgfQoKICAgIHsKICAgICAgaW50IGZsYWdzOwogICAgICBpZiAoKGZsYWdzID0g
ZmNudGwoc2QsIEZfR0VURkwsIDApKSA8IDApIHsKICAgICAgICBwZXJyb3IoImZhaWwgdG8gZ2V0
IGZsYWdzIik7CiAgICAgICAgZXhpdChFWElUX0ZBSUxVUkUpOwogICAgICB9CiAgICAgIGZsYWdz
IHw9IFNPQ0tfTk9OQkxPQ0s7CiAgICAgIGlmIChmY250bChzZCwgRl9TRVRGTCwgMCkgPCAwKSB7
CiAgICAgICAgcGVycm9yKCJmYWlsIHRvIHNldCBmbGFncyIpOwogICAgICAgIGV4aXQoRVhJVF9G
QUlMVVJFKTsKICAgICAgfQogICAgfQoKICAgIHsKICAgICAgc3RydWN0IHNjdHBfYXNzb2NfdmFs
dWUgYXNzb19hdXRoX29wdDsKICAgICAgYXNzb19hdXRoX29wdC5hc3NvY19pZCAgICA9IFNDVFBf
RlVUVVJFX0FTU09DOwogICAgICBhc3NvX2F1dGhfb3B0LmFzc29jX3ZhbHVlID0gc2Q7CiAgICAg
IGlmIChzZXRzb2Nrb3B0KHNkLCBTT0xfU0NUUCwgU0NUUF9BVVRIX1NVUFBPUlRFRCwKICAgICAg
ICAgICAgICAgICAgICAgJmFzc29fYXV0aF9vcHQsIHNpemVvZihhc3NvX2F1dGhfb3B0KSkgPCAw
KSB7CiAgICAgICAgcGVycm9yKCJmYWlsIHRvIHNldCBTQ1RQX0FVVEhfU1VQUE9SVEVEIik7CiAg
ICAgICAgZXhpdChFWElUX0ZBSUxVUkUpOwogICAgICB9CgogICAgICBzdHJ1Y3Qgc2N0cF9hdXRo
Y2h1bmsgZGF0YWNodW5rdHlwZTsKICAgICAgZGF0YWNodW5rdHlwZS5zYXV0aF9jaHVuayA9IDA7
CiAgICAgIGlmIChzZXRzb2Nrb3B0KHNkLCBTT0xfU0NUUCwgU0NUUF9BVVRIX0NIVU5LLAogICAg
ICAgICAgICAgICAgICAgICAmZGF0YWNodW5rdHlwZSwgc2l6ZW9mKHNjdHBfYXV0aGNodW5rKSkg
PCAwKSB7CiAgICAgICAgcGVycm9yKCJmYWlsIHRvIHNldCBTQ1RQX0FVVEhfQ0hVTksiKTsKICAg
ICAgICBleGl0KEVYSVRfRkFJTFVSRSk7CiAgICAgIH0KCiAgICAgIHVpbnQ4X3QgbnVtaG1hY3Mg
PSAyOwogICAgICB1aW50MzJfdCBobWFjYnVmbGVuID0gc2l6ZW9mKHNjdHBfaG1hY2FsZ28pICsg
KG51bWhtYWNzICogc2l6ZW9mKHVpbnQxNl90KSk7CiAgICAgIGNoYXIgaG1hY2J1ZltobWFjYnVm
bGVuXTsKICAgICAgc3RydWN0IHNjdHBfaG1hY2FsZ28gKm9wdGhtYWMgPSAoc3RydWN0IHNjdHBf
aG1hY2FsZ28gKikgaG1hY2J1ZjsKICAgICAgb3B0aG1hYy0+c2htYWNfbnVtX2lkZW50cyA9IG51
bWhtYWNzOwogICAgICBvcHRobWFjLT5zaG1hY19pZGVudHNbMF0gPSBTQ1RQX0FVVEhfSE1BQ19J
RF9TSEEyNTY7CiAgICAgIG9wdGhtYWMtPnNobWFjX2lkZW50c1sxXSA9IFNDVFBfQVVUSF9ITUFD
X0lEX1NIQTE7CiAgICAgIGlmIChzZXRzb2Nrb3B0KHNkLCBTT0xfU0NUUCwgU0NUUF9ITUFDX0lE
RU5ULAogICAgICAgICAgICAgICAgICAgICBvcHRobWFjLCBobWFjYnVmbGVuKSA8IDApIHsKICAg
ICAgICBwZXJyb3IoImZhaWwgdG8gc2V0IFNDVFBfSE1BQ19JREVOVCIpOwogICAgICAgIGV4aXQo
RVhJVF9GQUlMVVJFKTsKICAgICAgfQoKI2lmIDEKICAgICAgaW50IGtleWxlbiA9IDU7CiAgICAg
IHVpbnQzMl90IGtleWJ1ZmxlbiA9IGtleWxlbiArIHNpemVvZihzY3RwX2F1dGhrZXkpOwogICAg
ICBjaGFyIGtleWJ1ZltrZXlidWZsZW5dOwogICAgICBzdHJ1Y3Qgc2N0cF9hdXRoa2V5ICpvcHRf
a2V5ID0gKHN0cnVjdCBzY3RwX2F1dGhrZXkgKilrZXlidWY7CiAgICAgIG9wdF9rZXktPnNjYV9h
c3NvY19pZCAgPSBTQ1RQX0ZVVFVSRV9BU1NPQzsgLy8gZm9yIHRjcCBzdHlsZSB0aGlzIGlzIGln
bm9yZWQuIHNldCBzb21ldGhpbmcKICAgICAgb3B0X2tleS0+c2NhX2tleWxlbmd0aCA9IGtleWxl
bjsKICAgICAgb3B0X2tleS0+c2NhX2tleW51bWJlciA9IDE7CiAgICAgIG1lbWNweShvcHRfa2V5
LT5zY2Ffa2V5LCAibXlrZXkiLCBrZXlsZW4pOwogICAgICBpZiAoc2V0c29ja29wdChzZCwgU09M
X1NDVFAsIFNDVFBfQVVUSF9LRVksCiAgICAgICAgICAgICAgICAgICAgICZvcHRfa2V5LCBrZXli
dWZsZW4pIDwgMCkgewogICAgICAgIHBlcnJvcigiZmFpbCB0byBzZXQgU0NUUF9BVVRIX0tFWSIp
OwogICAgICAgIGV4aXQoRVhJVF9GQUlMVVJFKTsKICAgICAgfQojZW5kaWYKICAgIH0KCiAgICB7
CiAgICAgIGludCBvbiA9IDE7CiAgICAgIGlmIChzZXRzb2Nrb3B0KHNkLCBTT0xfU09DS0VULCBT
T19SRVVTRVBPUlQsICZvbiwgc2l6ZW9mKG9uKSkgPCAwKSB7CiAgICAgICAgcGVycm9yKCJmYWls
IHRvIHNldCBTT19SRVVTRVBPUlQiKTsKICAgICAgICBleGl0KEVYSVRfRkFJTFVSRSk7CiAgICAg
IH0KICAgIH0KCiAgICBpbnQgcmIgPSBiaW5kKHNkLCAoc3RydWN0IHNvY2thZGRyICopJnNlcnZl
ckFkZHJlc3MsIHNpemVvZihzZXJ2ZXJBZGRyZXNzKSk7CiAgICBpZihyYiA9PSAtMSkgewogICAg
ICAgIHBlcnJvcigiYmluZCBlcnJvciIpOwogICAgICAgIGNsb3NlKHNkKTsKICAgICAgICBleGl0
KEVYSVRfRkFJTFVSRSk7CiAgICB9CgogICAgaW50IHJsID0gbGlzdGVuKHNkLCAxKTsKICAgIGlm
KHJsIDwgMCkgewogICAgICAgIHBlcnJvcigiZmFpbGVkIHRvIGxpc3RlbiBmb3IgY29ubmVjdGlv
biIpOwogICAgICAgIGNsb3NlKHNkKTsKICAgICAgICBleGl0KEVYSVRfRkFJTFVSRSk7CiAgICB9
CgogICAgY2hhciBidWZbUkVDVkJVRlNJWkVdOwoKICAgIHN0cnVjdCBzY3RwX3NuZHJjdmluZm8g
c2luZm8gPSB7MH07CgogICAgaW50IG5ld3NkLCByY3ZkbGVuOwoKICAgIGZvcig7OykgewogICAg
ICAgIHN0cnVjdCBzb2NrYWRkcl9pbiAgY2xpZW50X2FkZHIgPSB7MH07CiAgICAgICAgc29ja2xl
bl90IHNvY2tsZW4gPSBzaXplb2YoY2xpZW50X2FkZHIpOwoKICAgICAgICBuZXdzZCA9IGFjY2Vw
dChzZCwgKHNvY2thZGRyKikmY2xpZW50X2FkZHIsICZzb2NrbGVuKTsKICAgICAgICBpZiAobmV3
c2QgPD0gMCkKICAgICAgICB7CiAgICAgICAgICBzd2l0Y2ggKGVycm5vKQogICAgICAgICAgewog
ICAgICAgICAgICBjYXNlIEVXT1VMREJMT0NLOgogICAgICAgICAgICAgIHBlcnJvcigiZmFpbCB0
byBhY2NlcHQgYmxvY2siKTsKICAgICAgICAgICAgICByZXR1cm4gRVhJVF9GQUlMVVJFOwogICAg
ICAgICAgICBjYXNlIEVJTlRSOgogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICBk
ZWZhdWx0OgogICAgICAgICAgICAgIHBlcnJvcigiZmFpbCB0byBzY3RwX3JlY3Ztc2ciKTsKICAg
ICAgICAgICAgICByZXR1cm4gRVhJVF9GQUlMVVJFOwogICAgICAgICAgfQogICAgICAgIH0KCiAg
ICAgICAgewogICAgICAgICAgaW50IGZsYWdzOwogICAgICAgICAgaWYgKChmbGFncyA9IGZjbnRs
KG5ld3NkLCBGX0dFVEZMLCAwKSkgPCAwKSB7CiAgICAgICAgICAgIHBlcnJvcigiZmFpbCB0byBn
ZXQgZmxhZ3MiKTsKICAgICAgICAgICAgZXhpdChFWElUX0ZBSUxVUkUpOwogICAgICAgICAgfQog
ICAgICAgICAgZmxhZ3MgfD0gU09DS19OT05CTE9DSzsKICAgICAgICAgIGlmIChmY250bChuZXdz
ZCwgRl9TRVRGTCwgMCkgPCAwKSB7CiAgICAgICAgICAgIHBlcnJvcigiZmFpbCB0byBzZXQgZmxh
Z3MiKTsKICAgICAgICAgICAgZXhpdChFWElUX0ZBSUxVUkUpOwogICAgICAgICAgfQoKICAgICAg
ICAgIHNjdHBfZXZlbnRfc3Vic2NyaWJlIGV2ZW50cyA9IHswfTsKICAgICAgICAgIGV2ZW50cy5z
Y3RwX2Fzc29jaWF0aW9uX2V2ZW50ID0gMTsKICAgICAgICAgIGV2ZW50cy5zY3RwX2RhdGFfaW9f
ZXZlbnQgICAgID0gMTsKICAgICAgICAgIGV2ZW50cy5zY3RwX3NodXRkb3duX2V2ZW50ICAgID0g
MTsKICAgICAgICAgIGV2ZW50cy5zY3RwX3BlZXJfZXJyb3JfZXZlbnQgID0gMTsKICAgICAgICAg
IGlmIChzZXRzb2Nrb3B0KG5ld3NkLCBJUFBST1RPX1NDVFAsIFNDVFBfRVZFTlRTLAogICAgICAg
ICAgICAgICAgICAgICAgICAgJmV2ZW50cywgc2l6ZW9mKGV2ZW50cykpIDwgMCkgewogICAgICAg
ICAgICBwZXJyb3IoImZhaWwgdG8gc2V0IFNDVFBfRVZFTlRTIik7CiAgICAgICAgICAgIGV4aXQo
RVhJVF9GQUlMVVJFKTsKICAgICAgICAgIH0KCiAgICAgICAgICBzY3RwX3BhZGRycGFyYW1zIGhl
YXJ0YmVhdHMgPSB7MH07CiAgICAgICAgICBoZWFydGJlYXRzLnNwcF9mbGFncyAgICAgID0gU1BQ
X0hCX0VOQUJMRSB8IFNQUF9QTVRVRF9ESVNBQkxFOwogICAgICAgICAgaGVhcnRiZWF0cy5zcHBf
aGJpbnRlcnZhbCA9IDUwMDA7CiAgICAgICAgICBoZWFydGJlYXRzLnNwcF9wYXRobWF4cnh0ID0g
MTsKICAgICAgICAgIGlmIChzZXRzb2Nrb3B0KG5ld3NkLCBTT0xfU0NUUCwgU0NUUF9QRUVSX0FE
RFJfUEFSQU1TLAogICAgICAgICAgICAgICAgICAgICAgICAgJmhlYXJ0YmVhdHMsIHNpemVvZiho
ZWFydGJlYXRzKSkgPCAwKSB7CiAgICAgICAgICAgIHBlcnJvcigiZmFpbCB0byBzZXQgU0NUUF9F
VkVOVFMiKTsKICAgICAgICAgICAgZXhpdChFWElUX0ZBSUxVUkUpOwogICAgICAgICAgfQoKICAg
ICAgICAgIHNjdHBfcnRvaW5mbyBydG9pbmZvID0gezB9OwogICAgICAgICAgaW50IHNjdHBydG8g
PSAyMDA7CiAgICAgICAgICBydG9pbmZvLnNydG9fbWluICAgICA9IHNjdHBydG87CiAgICAgICAg
ICBydG9pbmZvLnNydG9fbWF4ICAgICA9IDIgKiBzY3RwcnRvOwogICAgICAgICAgcnRvaW5mby5z
cnRvX2luaXRpYWwgPSAoMypzY3RwcnRvKS8yOwogICAgICAgICAgaWYgKHNldHNvY2tvcHQobmV3
c2QsIElQUFJPVE9fU0NUUCwgU0NUUF9SVE9JTkZPLAogICAgICAgICAgICAgICAgICAgICAgICAg
JnJ0b2luZm8sIHNpemVvZihydG9pbmZvKSkgPCAwKSB7CiAgICAgICAgICAgIHBlcnJvcigiZmFp
bCB0byBzZXQgU0NUUF9FVkVOVFMiKTsKICAgICAgICAgICAgZXhpdChFWElUX0ZBSUxVUkUpOwog
ICAgICAgICAgfQoKICAgICAgICAgIGludCByZmxhZ3M7CiAgICAgICAgICB3aGlsZSAoMSkKICAg
ICAgICAgIHsKICAgICAgICAgICAgaWYgKChyY3ZkbGVuID0gc2N0cF9yZWN2bXNnKG5ld3NkLCBi
dWYsIHNpemVvZihidWYpLCAwLCAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgJnNpbmZvLCAmcmZsYWdzKSkgPD0gMCkKICAgICAgICAgICAgewogICAgICAgICAgICAg
IHN3aXRjaCAoZXJybm8pCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgY2FzZSBFV09V
TERCTE9DSzoKICAgICAgICAgICAgICAgICAgcGVycm9yKCJmYWlsIHRvIHNjdHBfcmVjdm1zZyB3
b3VkbGJsb2NrIik7CiAgICAgICAgICAgICAgICAgIHJldHVybiBFWElUX0ZBSUxVUkU7CiAgICAg
ICAgICAgICAgICBjYXNlIEVJTlRSOgogICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAg
ICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgIHBlcnJvcigiZmFpbCB0byBzY3Rw
X3JlY3Ztc2ciKTsKICAgICAgICAgICAgICAgICAgcmV0dXJuIEVYSVRfRkFJTFVSRTsKICAgICAg
ICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHJmbGFncyAmIE1TR19OT1RJ
RklDQVRJT04pCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBmcHJpbnRmKHN0ZG91dCwgInNj
dHAgZXZlbnQgLSBjb250aW5lXG4iKTsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAg
ICAgfQoKICAgICAgICAgICAgZnByaW50ZihzdGRvdXQsICJyY3ZkICVkXG4iLCByY3ZkbGVuKTsK
ICAgICAgICAgICAgaWYgKHJjdmRsZW4pCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBidWZb
cmN2ZGxlbl0gPSAwOwogICAgICAgICAgICAgIGZwcmludGYoc3Rkb3V0LCAicmN2ZCBtc2cgJXMg
Ynl0ZXMgJWRcbiIsIGJ1ZiwgcmN2ZGxlbik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAg
ICAgICB9CiAgICB9CgogICAgcmV0dXJuIEVYSVRfU1VDQ0VTUzsKfQo=

--------------CWRqIyyln6zVDnTXsEB3geKn--

